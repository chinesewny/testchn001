<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <title>ChineseClass By Krukong</title>
  <link rel="icon" href="https://img2.pic.in.th/pic/Logoc404dc85753b800c.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <link rel="stylesheet" href="css/style.css">
 </head>
<body class="bg-[#F5F0E8] text-[#1A1A2E] font-sans min-h-screen selection:bg-[#C53D43] selection:text-[#1A1A2E] relative">
  
  <div id="app-root" class="w-full h-full min-h-screen flex items-stretch justify-center p-0 md:p-4">
    <div class="w-full max-w-7xl bg-transparent flex flex-col relative overflow-hidden">
    
   <header class="w-full px-6 py-4 border-b-4 border-[#C53D43] bg-white flex flex-col md:flex-row md:items-center md:justify-between gap-4 z-10 no-print relative">
    <div class="flex items-center gap-4">
        <div class="relative group">
            <img src="https://img2.pic.in.th/pic/Logoc404dc85753b800c.png" alt="School Logo" class="relative h-16 w-16 object-contain p-1 border-2 border-[#C53D43] rounded-sm bg-[#F5F0E8]">
        </div>
        <div>
            <h1 class="text-2xl font-bold text-[#1A1A2E] tracking-wide font-serif-thai">Chinese<span class="text-[#C53D43]">Class</span> By Krukong</h1>
            <p class="text-gray-500 text-xs">‡∏Ñ‡∏£‡∏π‡∏Å‡∏µ‡∏£‡∏ï‡∏¥ ‡∏õ‡∏£‡∏∞‡∏™‡∏û‡∏û‡∏£‡∏£‡∏±‡∏á‡∏™‡∏µ - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</p>
        </div>
    </div>
    
    <nav class="inline-flex rounded-sm bg-[#F5F0E8] p-1 border border-gray-300">
        <button id="tab-btn-admin" onclick="switchMainTab('admin')" class="px-6 py-2 rounded-sm text-sm font-bold text-gray-500 hover:text-[#1A1A2E] hover:bg-white transition-all">
            <i class="fa-solid fa-chalkboard-user mr-2"></i>‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π
        </button> 
        <button id="tab-btn-student" onclick="switchMainTab('student')" class="px-6 py-2 rounded-sm text-sm font-bold text-gray-500 hover:text-[#1A1A2E] hover:bg-white transition-all">
            <i class="fa-solid fa-user-graduate mr-2"></i>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </button>
    </nav>
</header>

    <main class="flex-1 w-full px-4 md:px-6 pb-6 overflow-y-auto no-print scroll-smooth">
     <div class="w-full max-w-7xl mx-auto mt-6 flex flex-col gap-6">
      
      <div id="section-admin" class="flex flex-col gap-5 hidden">
       <div id="admin-login-wrapper" class="flex flex-col items-center justify-center py-20 gap-8">
    <div class="bg-white p-10 rounded-sm border border-gray-200 shadow-sm w-full max-w-sm flex flex-col items-center relative overflow-hidden brush-border-top">
        
        <div class="seal-stamp top-6 right-6 w-12 h-12 text-lg transform rotate-12">
            Â∏´
        </div>

        <img src="https://img2.pic.in.th/pic/Logoc404dc85753b800c.png" alt="Logo" class="w-20 h-20 object-contain mb-4 opacity-90">
        <h2 class="text-2xl font-bold text-[#1A1A2E] mb-6 font-serif-thai tracking-wide">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π</h2>
        
        <form id="admin-login-form" class="space-y-6 w-full mt-4">
            <div>
                <input id="admin-username" type="text" placeholder="Username" class="w-full glass-input px-2 py-2 text-[#1A1A2E] text-center text-lg font-bold">
            </div>
            <div>
                <input id="admin-password" type="password" placeholder="Password" class="w-full glass-input px-2 py-2 text-[#1A1A2E] text-center text-lg font-bold">
            </div>
            <button type="submit" class="w-full py-3 rounded-sm bg-[#1A1A2E] text-white hover:bg-[#C53D43] font-bold shadow-md text-lg mt-4 transition-colors">
    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
</button>
        </form>
    </div>
</div>

        <div id="admin-content-wrapper" class="hidden flex flex-col gap-6">
            <div class="flex flex-col md:flex-row justify-between items-center bg-white border border-gray-200 px-6 py-4 rounded-sm shadow-sm brush-border-top relative overflow-hidden">
    
    <div class="absolute -right-4 -top-4 text-[80px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">
        ÁÆ°ÁêÜ
    </div>

    <div class="flex items-center gap-4 z-10 w-full md:w-auto mb-4 md:mb-0">
        <div class="w-12 h-12 rounded-full bg-[#F5F0E8] border-2 border-[#1A1A2E] flex items-center justify-center text-[#1A1A2E] text-xl">
            <i class="fa-solid fa-user-tie"></i>
        </div>
        <div>
            <h3 class="text-base font-bold text-[#1A1A2E] font-serif-thai">‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h3>
            <p class="text-[10px] text-green-600 font-bold tracking-widest uppercase">
                <i class="fa-solid fa-wifi mr-1"></i><span>Online</span>
            </p>
        </div>
    </div>

   <div class="flex flex-wrap items-center gap-2 z-10">
        <button onclick="window.handleManualBackup()" class="bg-[#1A1A2E] hover:bg-[#C53D43] text-white px-4 py-2 rounded-sm text-xs font-bold transition-colors flex items-center gap-2 shadow-sm">
            <i class="fa-solid fa-cloud-arrow-up"></i> ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>  
        <button onclick="handleRestoreFromSheet()" class="bg-white border border-gray-300 text-gray-600 hover:border-[#1A1A2E] hover:text-[#1A1A2E] px-3 py-2 rounded-sm text-xs transition-colors shadow-sm" title="‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
            <i class="fa-solid fa-cloud-arrow-down"></i> ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô
        </button>
        <div class="w-px h-6 bg-gray-300 mx-2 hidden md:block"></div>
        <button onclick="window.openChangePasswordModal()" class="text-gray-500 hover:text-[#1A1A2E] px-2 py-2 text-sm transition-colors" title="‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            <i class="fa-solid fa-key"></i>
        </button>
        <button onclick="handleLogout(true)" class="bg-white border border-gray-300 text-[#C53D43] hover:bg-[#C53D43] hover:text-white px-4 py-2 rounded-sm text-xs font-bold transition-colors shadow-sm">
            <i class="fa-solid fa-power-off mr-1"></i> ‡∏≠‡∏≠‡∏Å
        </button>
    </div>
</div>

<div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3 mt-6">
    <button onclick="switchAdminSubTab('basic')" id="menu-basic" class="menu-btn bg-[#1A1A2E] text-white rounded-sm py-4 font-bold shadow-md transition-all border border-[#1A1A2E]"><i class="fa-solid fa-folder-open block text-2xl mb-2"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button> 
    
    <button onclick="switchAdminSubTab('scan')" id="menu-scan" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-qrcode block text-2xl mb-2"></i> ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
    
    <button onclick="switchAdminSubTab('exam')" id="menu-exam" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all">
        <i class="fa-solid fa-graduation-cap block text-2xl mb-2"></i><span class="text-[11px]">‡∏ß‡∏±‡∏î‡∏ú‡∏•/‡∏™‡∏≠‡∏ö</span>
    </button>
    
    <button onclick="switchAdminSubTab('individual')" id="menu-individual" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-id-card block text-2xl mb-2"></i> ‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</button>
    
    <button onclick="switchAdminSubTab('report')" id="menu-report" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-print block text-2xl mb-2"></i> ‡∏û‡∏¥‡∏°‡∏û‡πå/CSV</button>
    
    <button onclick="switchAdminSubTab('homework')" id="menu-homework" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold relative transition-all"><i class="fa-solid fa-list-check block text-2xl mb-2"></i> ‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏≤‡∏ô<span id="badge-homework" class="absolute top-2 right-2 bg-[#C53D43] text-white text-[10px] px-2 py-0.5 rounded-sm hidden shadow-sm">0</span></button>
    
    <button onclick="switchAdminSubTab('management')" id="menu-management" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-table-columns block text-2xl mb-2"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
    
    <button onclick="switchAdminSubTab('attendance')" id="menu-attendance" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-user-check block text-2xl mb-2"></i> ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button>
    
    <button onclick="switchAdminSubTab('material')" id="menu-material" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-book-open block text-2xl mb-2"></i> ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</button>
    
    <button onclick="switchAdminSubTab('lucky')" id="menu-lucky" class="menu-btn bg-white border border-gray-200 text-[#D4AF37] hover:bg-[#D4AF37] hover:text-white rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-dice block text-2xl mb-2"></i> ‡∏™‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠</button>
    
    <button onclick="switchAdminSubTab('tools')" id="menu-tools" class="menu-btn bg-white border border-gray-200 text-gray-500 hover:border-[#C53D43] hover:text-[#C53D43] rounded-sm py-4 font-bold transition-all"><i class="fa-solid fa-id-card block text-2xl mb-2"></i> ‡∏ó‡∏≥‡∏ö‡∏±‡∏ï‡∏£</button>
</div>
<section id="admin-panel-basic" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 brush-border-top">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-6">
            <div class="bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-1 h-full bg-[#C53D43]"></div>
                <h4 class="text-sm font-bold text-[#1A1A2E] mb-4 uppercase tracking-wider font-serif-thai">1. ‡∏ß‡∏¥‡∏ä‡∏≤ & ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
                <form id="form-subject" class="flex gap-2 mb-4">
                    <input id="subject-name" class="flex-1 glass-input px-3 py-2 text-sm text-[#1A1A2E]" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤">
                    <button type="submit" class="bg-[#1A1A2E] hover:bg-[#C53D43] text-white px-4 py-2 rounded-sm text-xs font-bold transition-colors shadow-sm">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                </form>
                <form id="form-class" class="flex gap-2 pt-4 border-t border-gray-300">
                    <input id="class-name" class="flex-1 glass-input px-3 py-2 text-sm text-[#1A1A2E]" placeholder="‡∏´‡πâ‡∏≠‡∏á">
                    <select id="class-subject-ref" class="w-1/3 glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent">
                        <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                    </select>
                    <button type="submit" class="bg-[#1A1A2E] hover:bg-[#C53D43] text-white px-4 py-2 rounded-sm text-xs font-bold transition-colors shadow-sm">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                </form>
            </div>
            
            <div class="bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
                <h4 class="text-sm font-bold text-[#1A1A2E] mb-4 uppercase tracking-wider font-serif-thai">2. ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
                <form id="form-student" class="space-y-4">
                    <div class="grid grid-cols-12 gap-3">
                        <div class="col-span-5">
                            <select id="student-class" class="w-full glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent">
                                <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option>
                            </select>
                        </div>
                        <div class="col-span-3"><input id="student-no" type="number" class="w-full glass-input px-2 py-2 text-sm text-center text-[#1A1A2E]" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà"></div>
                        <div class="col-span-4"><input id="student-id" class="w-full glass-input px-2 py-2 text-sm text-[#1A1A2E]" placeholder="ID"></div>
                    </div>
                    <div><input id="student-name" class="w-full glass-input px-3 py-2 text-sm text-[#1A1A2E]" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"></div>
                    <button type="submit" class="w-full bg-[#C53D43] hover:bg-[#A03035] text-white py-2.5 rounded-sm text-sm font-bold transition-colors shadow-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                </form>
            </div>
        </div>
        
        <div class="bg-white p-5 rounded-sm border border-gray-200 h-full flex flex-col shadow-sm">
            <h4 class="text-sm font-bold text-[#1A1A2E] mb-4 uppercase tracking-wider border-b border-gray-200 pb-3 flex justify-between items-center font-serif-thai">
                <span><i class="fa-solid fa-sliders text-[#C53D43] mr-2"></i>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</span>
                <span class="text-[10px] text-gray-500 font-sans">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</span>
            </h4>
            <div id="subject-list-container" class="flex-1 overflow-y-auto space-y-2 pr-1 custom-scrollbar"></div>
        </div>
    </div>

    <div class="bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 mt-6 relative overflow-hidden">
        <h4 class="text-[#1A1A2E] font-bold mb-3 text-lg font-serif-thai"><i class="fa-solid fa-cogs text-gray-400 mr-2"></i>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h4>
        <p class="text-xs text-gray-500 mb-4">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="text-xs text-gray-600 ml-1 font-bold">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                <input type="text" id="setting-academic-year" class="glass-input w-full p-2 mt-1 text-sm text-[#1A1A2E]" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2567">
            </div>
            <div>
                <label class="text-xs text-gray-600 ml-1 font-bold">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                <select id="setting-semester" class="glass-input w-full p-2 mt-1 text-sm text-[#1A1A2E] bg-transparent">
                    <option class="text-black" value="1">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 1</option>
                    <option class="text-black" value="2">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 2</option>
                    <option class="text-black" value="3">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏§‡∏î‡∏π‡∏£‡πâ‡∏≠‡∏ô</option>
                </select>
            </div>
        </div>
        <button onclick="window.saveSystemSettings()" class="mt-4 bg-[#1A1A2E] hover:bg-[#C53D43] text-white px-6 py-2.5 rounded-sm text-sm font-bold shadow-sm transition-colors flex items-center gap-2">
            <i class="fa-solid fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        </button>
    </div>

    <div class="bg-white p-5 rounded-sm border border-gray-200 mt-6 shadow-sm relative overflow-hidden">
        <div class="absolute -right-4 -top-4 text-[60px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">Âêç</div>
        <h4 class="text-[#1A1A2E] font-bold mb-3 text-lg font-serif-thai relative z-10"><i class="fa-solid fa-users text-[#C53D43] mr-2"></i>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå (CSV)</h4>
        <p class="text-xs text-gray-500 mb-4 relative z-10">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏î‡πá‡∏Å‡πÉ‡∏´‡∏°‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 relative z-10">
            <div>
                <label class="text-xs text-gray-600 ml-1 font-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
                <select id="import-student-class" class="glass-input w-full p-2 mt-1 text-sm text-[#1A1A2E] bg-transparent">
                    <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
                </select>
            </div>
            <div class="flex items-end gap-2">
                <button onclick="window.downloadStudentCSVTemplate()" class="bg-[#1A1A2E] hover:bg-[#2D6A4F] text-white px-4 py-2.5 rounded-sm text-sm font-bold shadow-sm w-full transition-colors flex justify-center items-center gap-2">
                    <i class="fa-solid fa-download"></i> ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö/‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°
                </button>
            </div>
        </div>
        <div class="mt-4 p-4 border border-dashed border-gray-300 rounded-sm bg-[#F5F0E8] relative z-10">
            <label class="text-xs text-gray-600 ml-1 font-bold">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå CSV ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ / ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</label>
            <input type="file" id="import-student-file" accept=".csv" class="w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-sm file:border-0 file:text-sm file:font-bold file:bg-[#1A1A2E] file:text-white hover:file:bg-[#C53D43] mt-2 cursor-pointer transition-colors">
        </div>
        <button onclick="window.processStudentCSVImport()" class="mt-4 bg-[#C53D43] hover:bg-[#A03035] text-white px-6 py-2.5 rounded-sm text-sm font-bold shadow-sm transition-colors flex items-center gap-2 relative z-10">
            <i class="fa-solid fa-cloud-arrow-up"></i> ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠
        </button>
    </div>
               <div class="flex flex-col gap-6 mt-6">
    
                    <div class="bg-white p-5 rounded-sm border border-gray-200 relative overflow-hidden h-fit shadow-sm">
                         <div class="absolute top-0 left-0 w-1 h-full bg-[#D4AF37]"></div>
                         <h4 class="text-sm font-bold text-[#1A1A2E] mb-4 uppercase tracking-wider flex items-center font-serif-thai">
                             <i class="fa-solid fa-file-signature mr-2 text-[#D4AF37]"></i> 3.1 ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)
                         </h4>
                         <form id="form-task-accum" class="space-y-4">
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                 <div>
                                     <label class="text-[10px] text-gray-500 font-bold">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                                     <select id="task-subject-accum" class="w-full glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent" 
                                         onchange="renderTaskClassCheckboxesAccum(); renderTaskChapterCheckboxesAccum(); window.previewTasksBySubject('task-subject-accum', 'preview-area-accum');" required>
                                         <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤ --</option>
                                     </select>
                                 </div>
                                 <div>
                                     <label class="text-[10px] text-gray-500 font-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                                     <div id="task-class-accum" class="grid grid-cols-2 md:grid-cols-4 gap-2 bg-[#F5F0E8] border border-gray-200 rounded-sm p-2 max-h-32 overflow-y-auto custom-scrollbar"></div>
                                 </div>
                             </div>
                             
                             <div id="preview-area-accum" class="hidden animate-fade-in"></div>
                
                             <div>
                                 <label class="text-[10px] text-gray-500 font-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏á (Multi-Chapter)</label>
                                 <div id="task-chapter-accum" class="flex flex-wrap gap-2"></div>
                             </div>
                             <div class="grid grid-cols-12 gap-2">
                                 <div class="col-span-8">
                                     <input id="task-name-accum" class="w-full glass-input px-3 py-2 text-sm text-[#1A1A2E]" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà 1)" required>
                                 </div>
                                 <div class="col-span-4">
                                     <input id="task-max-accum" type="number" class="w-full glass-input px-2 py-2 text-sm text-center text-[#1A1A2E] font-bold" value="10" required>
                                 </div>
                             </div>
                             
                             <div class="mt-4 bg-[#F5F0E8] p-3 rounded-sm border border-gray-200">
                                <div class="mb-3">
                                    <label class="text-xs text-gray-600 ml-1 font-bold"><i class="fa-solid fa-align-left text-[#1A1A2E]"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô (‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á/‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°)</label>
                                    <textarea id="task-desc-accum" rows="3" class="glass-input w-full p-3 mt-1 text-sm text-[#1A1A2E] bg-white border border-gray-300 rounded-sm" placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏£‡∏≤‡∏ö..."></textarea>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600 ml-1 font-bold"><i class="fa-solid fa-image text-[#1A1A2E]"></i> ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ - ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1MB)</label>
                                    <input type="file" id="task-image-accum" accept="image/*" class="w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-sm file:border-0 file:text-sm file:font-bold file:bg-[#1A1A2E] file:text-white hover:file:bg-[#C53D43] mt-1 cursor-pointer transition-colors" onchange="window.previewTaskImageAccum(this)">
                                    
                                    <div id="task-image-preview-accum-container" class="hidden mt-3 relative inline-block">
                                        <img id="task-image-preview-accum" src="" class="max-h-40 rounded-sm border border-gray-300 shadow-sm p-1 bg-white">
                                        <button type="button" onclick="window.removeTaskImageAccum()" class="absolute -top-2 -right-2 bg-[#C53D43] text-white rounded-full w-7 h-7 flex items-center justify-center text-xs shadow-md hover:bg-[#A03035] transition-transform hover:scale-110">
                                            <i class="fa-solid fa-xmark"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                             <button type="submit" class="w-full bg-[#D4AF37] hover:bg-[#C39F2D] text-white py-3 rounded-sm text-sm font-bold shadow-sm transition-colors text-shadow-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
                         </form>
                    </div>
                
                    <div class="bg-white p-5 rounded-sm border border-gray-200 relative overflow-hidden h-fit shadow-sm">
                         <div class="absolute top-0 left-0 w-1 h-full bg-[#C53D43]"></div>
                         <h4 class="text-sm font-bold text-[#1A1A2E] mb-4 uppercase tracking-wider flex items-center font-serif-thai">
                             <i class="fa-solid fa-graduation-cap mr-2 text-[#C53D43]"></i> 3.2 ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö / ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ä‡πà‡∏ß‡∏¢
                         </h4>
                         <form id="form-task-exam" class="space-y-4">
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                 <div>
                                     <label class="text-[10px] text-gray-500 font-bold">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                                     <select id="task-subject-exam" class="w-full glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent" 
                                         onchange="renderTaskClassCheckboxesExam(); window.previewTasksBySubject('task-subject-exam', 'preview-area-exam');" required>
                                         <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤ --</option>
                                     </select>
                                 </div>
                                 <div>
                                     <label class="text-[10px] text-gray-500 font-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                                     <div id="task-class-exam" class="grid grid-cols-2 md:grid-cols-4 gap-2 bg-[#F5F0E8] border border-gray-200 rounded-sm p-2 max-h-32 overflow-y-auto custom-scrollbar"></div>
                                 </div>
                             </div>
                
                             <div id="preview-area-exam" class="hidden animate-fade-in"></div>
                
                             <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                 <div>
                                     <label class="text-[10px] text-gray-500 font-bold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö</label>
                                     <select id="task-category-exam" class="w-full glass-input px-2 py-2 text-sm font-bold text-[#C53D43] bg-transparent">
                                         <option class="text-black" value="midterm">‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ (Midterm)</option>
                                         <option class="text-black" value="special_mid">++ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</option>
                                         <option class="text-black" value="final">‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ (Final)</option>
                                         <option class="text-black" value="special_final">++ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</option>
                                     </select>
                                 </div>
                                 <div>
                                     <label class="text-[10px] text-gray-500 font-bold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°</label>
                                     <input id="task-max-exam" type="number" class="w-full glass-input px-2 py-2 text-sm text-center font-bold text-[#1A1A2E]" value="20">
                                 </div>
                             </div>
                             <button type="submit" class="w-full bg-[#C53D43] hover:bg-[#A03035] text-white py-3 rounded-sm text-sm font-bold shadow-sm transition-colors">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</button>
                         </form>
                    </div>
                </div>

                <div class="bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 relative overflow-hidden h-fit shadow-sm mt-6">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#2D6A4F]"></div>
                    <h4 class="text-sm font-bold text-[#1A1A2E] mb-4 uppercase tracking-wider flex items-center font-serif-thai">
                        <i class="fa-solid fa-file-csv mr-2 text-[#2D6A4F]"></i> 3.3 ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå (CSV Import)
                    </h4>
                    
                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="text-[10px] text-gray-500 font-bold">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                                <select id="import-class-select" class="w-full glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent" onchange="renderImportTasks()">
                                    <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-[10px] text-gray-500 font-bold">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤</label>
                                <select id="import-subject-select" class="w-full glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent" onchange="renderImportTasks()">
                                    <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤ --</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-[10px] text-gray-500 font-bold">3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô/‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</label>
                                <select id="import-task-select" class="w-full glass-input px-2 py-2 text-sm text-[#C53D43] font-bold bg-transparent">
                                    <option class="text-black" value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡πà‡∏≠‡∏ô --</option>
                                </select>
                            </div>
                        </div>
                
                        <div class="bg-white p-3 rounded-sm border border-gray-200 flex justify-between items-center">
                            <div>
                                <div class="text-xs text-[#1A1A2E] font-bold">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö (Template)</div>
                                <div class="text-[10px] text-gray-500">‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡πá‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏Ñ‡πà‡∏ä‡πà‡∏≠‡∏á Score</div>
                            </div>
                            <button onclick="downloadCSVTemplate()" class="px-3 py-2 bg-[#1A1A2E] hover:bg-[#C53D43] text-white text-xs rounded-sm transition-colors font-bold">
                                <i class="fa-solid fa-download mr-1"></i> ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå CSV
                            </button>
                        </div>
                
                        <div class="mt-2">
                            <label class="text-[10px] text-gray-500 mb-1 block font-bold">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå CSV ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß</label>
                            <div class="flex gap-2 items-center">
                                <input type="file" id="import-file-input" accept=".csv" class="flex-1 glass-input px-2 py-1.5 text-xs text-gray-600 file:mr-4 file:py-1.5 file:px-3 file:rounded-sm file:border-0 file:text-xs file:font-bold file:bg-[#F5F0E8] file:text-[#1A1A2E] hover:file:bg-gray-200 cursor-pointer border-b-0">
                                <button onclick="processCSVImport()" class="px-4 py-2 bg-[#2D6A4F] hover:bg-[#1B4332] text-white text-xs font-bold rounded-sm shadow-sm transition-colors">
                                    <i class="fa-solid fa-file-import mr-1"></i> ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-5 rounded-sm border border-gray-200 relative overflow-hidden h-fit shadow-sm mt-6 mb-6">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
                    <h4 class="text-sm font-bold text-[#1A1A2E] mb-4 uppercase tracking-wider flex items-center font-serif-thai">
                        <i class="fa-solid fa-calendar-days mr-2"></i> 4. ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ô (Timetable)
                    </h4>
                    <form id="form-schedule" class="space-y-4">
                        <div class="grid grid-cols-2 gap-2">
                            <select id="sch-day" class="glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent">
                                <option class="text-black" value="1">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</option><option class="text-black" value="2">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</option><option class="text-black" value="3">‡∏û‡∏∏‡∏ò</option><option class="text-black" value="4">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</option><option class="text-black" value="5">‡∏®‡∏∏‡∏Å‡∏£‡πå</option><option class="text-black" value="6">‡πÄ‡∏™‡∏≤‡∏£‡πå</option><option class="text-black" value="0">‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå</option>
                            </select>
                            <select id="sch-period" class="glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent">
                                <option class="text-black" value="1">‡∏Ñ‡∏≤‡∏ö 1 (08:30)</option><option class="text-black" value="2">‡∏Ñ‡∏≤‡∏ö 2 (09:20)</option><option class="text-black" value="3">‡∏Ñ‡∏≤‡∏ö 3 (10:10)</option><option class="text-black" value="4">‡∏Ñ‡∏≤‡∏ö 4 (11:00)</option><option class="text-black" value="5">‡∏Ñ‡∏≤‡∏ö 5 (11:50)</option><option class="text-black" value="6">‡∏Ñ‡∏≤‡∏ö 6 (12:40)</option><option class="text-black" value="7">‡∏Ñ‡∏≤‡∏ö 7 (13:30)</option><option class="text-black" value="8">‡∏Ñ‡∏≤‡∏ö 8 (14:20)</option>
                            </select>
                        </div>
                        <select id="sch-class" class="w-full glass-input px-2 py-2 text-sm text-[#1A1A2E] bg-transparent">
                            <option class="text-black" value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô --</option>
                        </select>
                        <button type="submit" class="w-full bg-[#1A1A2E] hover:bg-[#C53D43] text-white py-2 rounded-sm text-sm font-bold shadow-sm transition-colors">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á</button>
                    </form>
                    <div id="schedule-list" class="mt-4 max-h-40 overflow-y-auto space-y-2 pr-1 custom-scrollbar"></div>
               </div>
            </section>
            
            <section id="admin-panel-scan" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 flex flex-col gap-6 brush-border-top relative overflow-hidden">
    
    <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">
        ÂàÜ
    </div>
    
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 min-h-[500px] relative z-10">
        <div class="lg:col-span-1 bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 flex flex-col gap-5 relative shadow-sm">
            <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
            
            <h3 class="font-bold text-[#1A1A2E] text-lg border-b border-gray-300 pb-2 font-serif-thai">
                <i class="fa-solid fa-qrcode mr-2 text-[#C53D43]"></i>‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
            </h3>
            
            <div>
                <label class="text-xs text-gray-500 font-bold">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á/‡∏á‡∏≤‡∏ô</label>
                <select id="scan-class-select" class="w-full glass-input px-2 py-2 text-sm mb-2 text-[#1A1A2E] bg-transparent">
                    <option class="text-black" value="">-- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• --</option>
                </select>
                <select id="scan-task-select" class="w-full glass-input px-2 py-2 text-sm font-bold text-[#C53D43] bg-transparent">
                    <option class="text-black" value="">-- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• --</option>
                </select>
            </div>
            
            <div class="bg-white p-3 rounded-sm border border-gray-200 flex flex-col gap-2 shadow-sm">
                <label class="text-xs text-gray-500 font-bold">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</label>
                <div id="score-buttons-container" class="grid grid-cols-5 gap-1"></div>
                <button onclick="setScoreMode('manual')" id="btn-score-manual" class="w-full py-2 rounded-sm border border-gray-300 bg-[#F5F0E8] text-gray-600 text-xs font-bold hover:bg-gray-200 transition-colors mt-1">
                    ‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á
                </button>
            </div>
            
            <div>
                <label class="text-xs text-gray-500 block mb-2 font-bold">3. ‡∏™‡πÅ‡∏Å‡∏ô/‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™</label>
                <input id="scan-score-input" type="text" class="w-full px-4 py-3 text-lg text-center font-bold focus:border-[#C53D43] focus:ring-1 focus:ring-[#C53D43] outline-none text-[#1A1A2E] bg-white border-2 border-gray-300 rounded-sm transition-all" placeholder="‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πÅ‡∏Å‡∏ô...">
            </div>
        </div>
        
        <div class="lg:col-span-3 bg-white p-5 rounded-sm border border-gray-200 flex flex-col shadow-sm">
            <div class="flex justify-between items-center mb-4 border-b border-gray-100 pb-3">
                <h3 class="font-bold text-[#1A1A2E] font-serif-thai">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <span class="text-xs text-[#2D6A4F] font-bold tracking-widest uppercase animate-pulse flex items-center gap-1">
                    <i class="fa-solid fa-wifi"></i> Syncing (Auto 5s)
                </span>
            </div>
            <div id="score-roster-grid" class="grid grid-cols-2 md:grid-cols-4 xl:grid-cols-5 gap-3 overflow-y-auto max-h-[600px] p-1 custom-scrollbar"></div>
        </div>
    </div>
</section>

<section id="admin-panel-individual" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 brush-border-top relative overflow-hidden">
    <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">‰∫∫</div>
    
    <div class="flex flex-col gap-6 min-h-[500px] relative z-10">
        <div class="bg-[#F5F0E8] p-4 rounded-sm border border-gray-200 relative">
            <label class="text-xs text-[#1A1A2E] block mb-2 font-bold font-serif-thai">
                <i class="fa-solid fa-magnifying-glass mr-1 text-[#C53D43]"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™)
            </label>
            <input type="text" id="individual-search" class="w-full bg-white border-b-2 border-gray-300 rounded-none px-4 py-3 text-[#1A1A2E] text-lg focus:border-[#C53D43] outline-none transition-colors" placeholder="‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠..." onkeyup="searchIndividual(this.value)">
            <div id="individual-search-results" class="absolute top-[85px] left-0 w-full bg-white border border-gray-200 rounded-sm max-h-60 overflow-y-auto hidden z-50 shadow-md"></div>
        </div>

        <div id="individual-result-container" class="hidden flex-col gap-6 animate-fade-in">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4 p-5 bg-white border border-[#D4AF37] rounded-sm shadow-sm relative overflow-hidden">
                <div class="absolute top-0 left-0 w-1 h-full bg-[#D4AF37]"></div>
                <div class="flex items-center gap-4">
                    <div class="w-16 h-16 rounded-full bg-[#F5F0E8] border border-gray-300 flex items-center justify-center text-3xl shadow-sm text-[#1A1A2E]">üéì</div>
                    <div>
                        <h2 id="ind-name" class="text-2xl font-bold text-[#1A1A2E] tracking-wide font-serif-thai"></h2>
                        <p class="text-gray-600 text-sm font-mono mt-1">
                            <span id="ind-id" class="bg-[#F5F0E8] border border-gray-200 px-2 py-0.5 rounded-sm mr-2 text-[#1A1A2E]"></span> 
                            <span id="ind-class"></span>
                        </p>
                    </div>
                </div>
                <div class="flex gap-4 bg-[#F5F0E8] p-3 rounded-sm border border-gray-200">
                    <div class="text-center px-4 border-r border-gray-300">
                        <div class="text-[10px] text-gray-500 uppercase mb-1 font-bold">‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</div>
                        <div id="ind-score-mid" class="text-xl font-bold text-[#1A1A2E]">-</div>
                    </div>
                    <div class="text-center px-4 border-r border-gray-300">
                        <div class="text-[10px] text-gray-500 uppercase mb-1 font-bold">‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</div>
                        <div id="ind-score-final" class="text-xl font-bold text-[#1A1A2E]">-</div>
                    </div>
                    <div class="text-center px-4">
                        <div class="text-[10px] text-[#C53D43] uppercase mb-1 font-bold">‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</div>
                        <div id="ind-gpa" class="text-2xl font-bold text-[#C53D43] drop-shadow-sm">-</div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white p-5 rounded-sm border border-gray-200 relative overflow-hidden shadow-sm">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#2D6A4F]"></div>
                    <h3 class="text-lg font-bold text-[#1A1A2E] mb-4 flex items-center font-serif-thai"><i class="fa-solid fa-user-clock mr-2 text-[#2D6A4F]"></i>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                    <div class="grid grid-cols-4 gap-2 text-center mb-4">
                        <div class="bg-white border border-[#2D6A4F] rounded-sm p-3"><div id="ind-att-present" class="text-2xl font-bold text-[#2D6A4F]">0</div><div class="text-[10px] text-gray-500 uppercase font-bold">‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div></div>
                        <div class="bg-white border border-[#D4AF37] rounded-sm p-3"><div id="ind-att-leave" class="text-2xl font-bold text-[#D4AF37]">0</div><div class="text-[10px] text-gray-500 uppercase font-bold">‡∏•‡∏≤</div></div>
                        <div class="bg-white border border-[#C53D43] rounded-sm p-3"><div id="ind-att-absent" class="text-2xl font-bold text-[#C53D43]">0</div><div class="text-[10px] text-gray-500 uppercase font-bold">‡∏Ç‡∏≤‡∏î</div></div>
                        <div class="bg-white border border-blue-500 rounded-sm p-3"><div id="ind-att-activity" class="text-2xl font-bold text-blue-600">0</div><div class="text-[10px] text-gray-500 uppercase font-bold">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div></div>
                    </div>
                    <div class="bg-[#F5F0E8] rounded-sm p-3 border border-gray-200">
                        <div class="text-xs text-[#C53D43] font-bold mb-1"><i class="fa-solid fa-calendar-xmark mr-1"></i> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</div>
                        <div id="ind-absent-dates" class="text-xs text-gray-600 leading-relaxed">-</div>
                    </div>
                </div>

                <div class="bg-white p-5 rounded-sm border border-gray-200 relative overflow-hidden shadow-sm">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#D4AF37]"></div>
                    <h3 class="text-lg font-bold text-[#1A1A2E] mb-4 flex items-center font-serif-thai"><i class="fa-solid fa-list-check mr-2 text-[#D4AF37]"></i>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</h3>
                    <div class="flex items-center gap-4 mb-6">
                        <div class="flex-1">
                            <div class="flex justify-between text-xs text-gray-500 mb-1 font-bold"><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span><span id="ind-work-progress-text" class="text-[#1A1A2E] font-bold">0%</span></div>
                            <div class="w-full bg-[#F5F0E8] rounded-sm h-2.5 overflow-hidden border border-gray-200"><div id="ind-work-bar" class="bg-[#D4AF37] h-2.5 transition-all duration-1000" style="width: 0%"></div></div>
                        </div>
                    </div>
                    <h4 class="text-xs font-bold text-gray-500 mb-2 border-b border-gray-200 pb-1 uppercase tracking-wider">‚ö†Ô∏è ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á (Missing Tasks)</h4>
                    <div class="space-y-2 max-h-48 overflow-y-auto pr-1 text-[#1A1A2E]" id="ind-missing-list"></div>
                </div>
            </div>

            <div class="bg-[#F5F0E8] p-6 rounded-sm border border-gray-200 relative overflow-hidden shadow-inner">
                <div class="flex justify-between items-center mb-6 border-b border-gray-300 pb-3">
                    <h3 class="text-lg font-bold text-[#1A1A2E] flex items-center font-serif-thai">
                        <i class="fa-solid fa-scroll mr-2 text-[#C53D43]"></i> ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏≤‡∏ô
                    </h3>
                    <span class="text-[10px] bg-white px-2 py-1 border border-gray-300 rounded-sm text-gray-400 font-bold">LOG SYSTEM ACTIVE</span>
                </div>
                
                <div id="ind-timeline-container" class="max-h-[500px] overflow-y-auto custom-scrollbar pr-4">
                    <div class="text-center text-gray-400 py-10 italic">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤...</div>
                </div>
            </div>
            
        </div> </div>
</section>

            <section id="admin-panel-report" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 flex flex-col gap-6 brush-border-top relative overflow-hidden">
                <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">Êä•</div>
                <div class="flex flex-col md:flex-row items-center justify-between gap-4 z-10">
                    <h3 class="text-xl font-bold text-[#1A1A2E] font-serif-thai">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                    <div class="flex gap-3">
                        <button onclick="printOfficialReport()" class="bg-[#1A1A2E] hover:bg-[#C53D43] text-white px-6 py-2.5 rounded-sm text-sm font-bold flex gap-2 shadow-sm items-center transition-colors"><i class="fa-solid fa-print"></i> ‡∏û‡∏¥‡∏°‡∏û‡πå PDF</button>
                        <button onclick="exportGradeCSV()" class="bg-white hover:bg-gray-100 border border-gray-300 text-[#1A1A2E] px-6 py-2.5 rounded-sm text-sm font-bold flex gap-2 shadow-sm items-center transition-colors"><i class="fa-solid fa-file-csv"></i> ‡πÇ‡∏´‡∏•‡∏î CSV</button>
                    </div>
                </div>
                <div class="bg-[#F5F0E8] p-4 rounded-sm border border-gray-200 flex flex-col md:flex-row gap-4 z-10">
                    <div class="flex-1"><label class="text-xs text-gray-500 block mb-1 font-bold">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤</label><select id="report-subject" class="w-full bg-white border border-gray-300 rounded-sm px-4 py-2 text-sm text-[#1A1A2E] outline-none"></select></div>
                    <div class="flex-1"><label class="text-xs text-gray-500 block mb-1 font-bold">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label><select id="report-class" class="w-full bg-white border border-gray-300 rounded-sm px-4 py-2 text-sm text-[#1A1A2E] outline-none"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡πà‡∏≠‡∏ô --</option></select></div>
                </div>
                <div class="flex flex-col sm:flex-row gap-4 mb-4 bg-white p-3 rounded-sm border border-gray-200 z-10">
                    <label class="text-xs text-gray-500 my-auto mr-2 font-bold">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:</label>
                    <label class="flex items-center gap-2 cursor-pointer bg-[#F5F0E8] px-3 py-2 rounded-sm border border-gray-300 hover:border-[#C53D43] transition-all">
                        <input type="radio" name="reportType" value="summary" checked class="accent-[#C53D43] w-4 h-4">
                        <span class="text-[#1A1A2E] text-xs font-bold">‡πÅ‡∏ö‡∏ö‡∏™‡∏£‡∏∏‡∏õ (5 ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö + ‡∏™‡∏≠‡∏ö)</span>
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer bg-[#F5F0E8] px-3 py-2 rounded-sm border border-gray-300 hover:border-[#1A1A2E] transition-all">
                        <input type="radio" name="reportType" value="detailed" class="accent-[#1A1A2E] w-4 h-4">
                        <span class="text-[#1A1A2E] text-xs font-bold">‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô)</span>
                    </label>
                </div>
                <div class="overflow-x-auto bg-white rounded-sm border border-gray-200 z-10">
                    <table class="min-w-full text-sm text-[#1A1A2E]">
                        <thead class="bg-[#F5F0E8] text-xs uppercase font-bold text-gray-600 border-b border-gray-300"><tr id="report-table-header"></tr></thead>
                        <tbody id="report-table-body" class="divide-y divide-gray-200"></tbody>
                    </table>
                </div>
            </section>

            <section id="admin-panel-exam" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 flex flex-col gap-6 h-full brush-border-top relative overflow-hidden">
                <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">ËÄÉ</div>
                <div class="flex flex-col md:flex-row items-center justify-between gap-4 border-b border-gray-200 pb-4 shrink-0 z-10">
                    <div>
                        <h3 class="text-xl font-bold text-[#1A1A2E] font-serif-thai">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö & ‡∏ï‡∏±‡∏î‡πÄ‡∏Å‡∏£‡∏î</h3>
                        <p class="text-xs text-gray-500">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ/‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ ‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
                    </div>
                    <div class="flex gap-2 bg-[#F5F0E8] p-1 rounded-sm border border-gray-200">
                        <button onclick="setExamTab('midterm')" id="tab-exam-mid" class="px-6 py-2 rounded-sm text-sm font-bold bg-[#1A1A2E] text-white shadow-sm transition-all">‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</button>
                        <button onclick="setExamTab('final')" id="tab-exam-final" class="px-6 py-2 rounded-sm text-sm font-bold text-gray-500 hover:text-[#1A1A2E] transition-all">‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</button>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 flex-1 min-h-0 z-10">
                    <div class="md:col-span-1 flex flex-col gap-4 overflow-y-auto pr-1 custom-scrollbar">
                        <div class="bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 shadow-sm relative">
                            <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
                            <label class="text-xs text-gray-600 mb-1 block font-bold">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                            <select id="exam-class-select" class="w-full bg-white border border-gray-300 rounded-sm px-4 py-2 text-sm mb-4 text-[#1A1A2E]" onchange="renderExamPanel()"></select>
                            <label class="text-xs text-gray-600 mb-1 block font-bold">2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏° (Max)</label>
                            <div class="flex gap-2">
                                <input type="number" id="exam-max-score" class="w-full bg-white border border-gray-300 rounded-sm px-3 py-2 text-center font-bold text-[#C53D43] outline-none focus:border-[#C53D43]" value="20">
                                <button onclick="updateExamConfig()" class="bg-[#1A1A2E] text-white px-4 rounded-sm font-bold text-xs shadow-sm hover:bg-[#C53D43] transition-colors">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                            </div>
                        </div>
                        <div class="bg-white p-5 rounded-sm border border-gray-200 shadow-sm relative">
                            <div class="absolute top-0 left-0 w-1 h-full bg-[#C53D43]"></div>
                            <h4 class="text-sm font-bold text-[#1A1A2E] mb-3 flex items-center font-serif-thai"><i class="fa-solid fa-file-csv mr-2 text-[#C53D43]"></i>‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (CSV)</h4>
                            <button onclick="downloadExamTemplate()" class="w-full py-2.5 rounded-sm bg-[#F5F0E8] border border-gray-300 text-[#1A1A2E] font-bold text-xs mb-4 hover:border-[#C53D43] transition-all flex justify-center items-center gap-2">
                                <i class="fa-solid fa-download"></i> ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠
                            </button>
                            <div class="border-t border-gray-200 pt-3">
                                <p class="text-[10px] text-gray-500 mb-2 font-bold">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå (Format: ‡∏£‡∏´‡∏±‡∏™, ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</p>
                                <input type="file" id="exam-csv-input" accept=".csv" class="hidden">
                                <button onclick="document.getElementById('exam-csv-input').click()" class="w-full py-2.5 rounded-sm bg-[#1A1A2E] text-white font-bold text-xs shadow-sm mb-2 hover:bg-[#C53D43] transition-colors flex justify-center items-center gap-2">
                                    <i class="fa-solid fa-folder-open"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå CSV
                                </button>
                                <div id="csv-file-name" class="text-[10px] text-center text-gray-500 mb-2 h-4 truncate">- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå -</div>
                                <button onclick="processExamCSV()" id="btn-process-csv" class="w-full py-2.5 rounded-sm bg-gray-200 text-gray-400 font-bold text-xs pointer-events-none transition-all">
                                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="md:col-span-2 bg-white p-1 rounded-sm border border-gray-200 flex flex-col shadow-sm relative overflow-hidden">
                        <div class="p-4 flex justify-between items-center bg-[#F5F0E8] border-b border-gray-200 shrink-0">
                            <h4 class="font-bold text-[#1A1A2E] flex items-center font-serif-thai"><i class="fa-solid fa-users-viewfinder mr-2 text-[#C53D43]"></i>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h4>
                            <div class="flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-[#2D6A4F] animate-pulse"></span><span class="text-xs text-[#2D6A4F] font-bold">Auto Save</span></div>
                        </div>
                        <div class="flex-1 overflow-y-auto custom-scrollbar">
                            <table class="w-full text-sm text-left text-[#1A1A2E]">
                                <thead class="text-xs text-gray-600 uppercase bg-white sticky top-0 shadow-sm border-b border-gray-200 z-10">
                                    <tr><th class="px-4 py-3 text-center w-16">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</th><th class="px-4 py-3">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th><th class="px-4 py-3 text-center w-32">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th></tr>
                                </thead>
                                <tbody id="exam-table-body" class="divide-y divide-gray-100"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section id="admin-panel-attendance" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 flex flex-col gap-6 brush-border-top relative overflow-hidden">
                <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">Âã§</div>
                
                <div id="smart-att-banner" class="hidden bg-[#F5F0E8] border-l-4 border-[#D4AF37] border-y border-r border-gray-200 rounded-sm p-4 flex items-center justify-between shadow-sm z-10">
                    <div class="flex items-center gap-4">
                        <div class="h-12 w-12 rounded-full bg-white border border-[#D4AF37] flex items-center justify-center text-[#D4AF37] text-2xl animate-pulse"><i class="fa-solid fa-bell"></i></div>
                        <div><h3 class="font-bold text-[#1A1A2E] text-lg font-serif-thai">‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß!</h3><p class="text-gray-600 text-sm">‡∏Ñ‡∏≤‡∏ö <span id="smart-period" class="font-bold text-[#1A1A2E]"></span> : ‡∏´‡πâ‡∏≠‡∏á <span id="smart-class-name" class="font-bold text-[#C53D43] text-lg"></span></p></div>
                    </div>
                    <button onclick="useSmartClass()" class="bg-[#D4AF37] hover:bg-[#C39F2D] text-white px-6 py-2 rounded-sm font-bold shadow-sm transition-colors">‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ</button>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 min-h-[500px] z-10">
                    <div class="lg:col-span-1 bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 flex flex-col gap-5 relative">
                        <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
                        <h3 class="font-bold text-[#1A1A2E] text-lg border-b border-gray-300 pb-2 font-serif-thai">‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° & ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                        <div class="bg-white p-3 rounded-sm border border-gray-200 mb-2 shadow-sm">
                            <label class="text-xs text-gray-500 mb-1 block font-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                            <input id="att-date-input" type="date" class="w-full border-b border-gray-300 bg-transparent px-3 py-2 text-sm font-mono text-center mb-2 outline-none focus:border-[#C53D43] text-[#1A1A2E]">
                            <select id="att-class-select" class="w-full border-b border-gray-300 bg-transparent px-3 py-2 text-sm mb-2 mt-1 outline-none focus:border-[#C53D43] text-[#1A1A2E]"></select>
                            <div id="att-stats" class="text-center py-2 border-t border-gray-200 mt-2">
                                <div class="grid grid-cols-4 gap-1 mt-1 text-sm font-bold">
                                    <div class="text-[#2D6A4F]"><i class="fa-solid fa-check"></i> <span id="stat-present">0</span></div>
                                    <div class="text-[#D4AF37]"><i class="fa-solid fa-envelope-open-text"></i> <span id="stat-leave">0</span></div>
                                    <div class="text-[#C53D43]"><i class="fa-solid fa-xmark"></i> <span id="stat-absent">0</span></div>
                                    <div class="text-blue-600"><i class="fa-solid fa-flag"></i> <span id="stat-activity">0</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="mb-2">
                            <label class="text-xs text-gray-500 block mb-1 font-bold">üì∑ ‡πÇ‡∏´‡∏°‡∏î‡∏™‡πÅ‡∏Å‡∏ô</label>
                            <input id="att-scan-input" type="text" class="w-full bg-white border-2 border-gray-300 rounded-sm px-4 py-3 text-lg text-center font-bold text-[#1A1A2E] focus:border-[#C53D43] outline-none transition-colors" placeholder="‡∏¢‡∏¥‡∏á‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î..." autocomplete="off">
                        </div>
                        <div class="space-y-2">
                            <button onclick="setAttMode('‡∏°‡∏≤')" id="btn-att-present" class="w-full py-2.5 rounded-sm border border-gray-300 bg-white text-gray-600 hover:border-[#2D6A4F] hover:text-[#2D6A4F] font-bold flex justify-between px-4 transition-all"><span>‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span> <i class="fa-solid fa-check"></i></button>
                            <button onclick="setAttMode('‡∏•‡∏≤')" id="btn-att-leave" class="w-full py-2.5 rounded-sm border border-gray-300 bg-white text-gray-600 hover:border-[#D4AF37] hover:text-[#D4AF37] font-bold flex justify-between px-4 transition-all"><span>‡∏•‡∏≤</span> <i class="fa-solid fa-envelope-open-text"></i></button>
                            <button onclick="setAttMode('‡∏Ç‡∏≤‡∏î')" id="btn-att-absent" class="w-full py-2.5 rounded-sm border border-gray-300 bg-white text-gray-600 hover:border-[#C53D43] hover:text-[#C53D43] font-bold flex justify-between px-4 transition-all"><span>‡∏Ç‡∏≤‡∏î</span> <i class="fa-solid fa-xmark"></i></button>
                            <button onclick="setAttMode('‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°')" id="btn-att-activity" class="w-full py-2.5 rounded-sm border border-gray-300 bg-white text-gray-600 hover:border-blue-500 hover:text-blue-600 font-bold flex justify-between px-4 transition-all"><span>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</span> <i class="fa-solid fa-flag"></i></button>
                        </div>
                        <div class="mt-auto pt-4 border-t border-gray-300">
                            <button onclick="exportAttendanceCSV()" class="w-full py-3 rounded-sm bg-[#1A1A2E] hover:bg-[#C53D43] text-white font-bold shadow-sm transition-colors"><i class="fa-solid fa-file-csv mr-2"></i>‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ (CSV)</button>
                        </div>
                    </div>
                    <div class="lg:col-span-3 bg-white p-5 rounded-sm border border-gray-200 flex flex-col shadow-sm">
                        <div id="att-roster-grid" class="grid grid-cols-2 md:grid-cols-4 xl:grid-cols-5 gap-3 overflow-y-auto max-h-[600px] p-1 custom-scrollbar"></div>
                    </div>
                </div>
            </section>
            
            <section id="admin-panel-homework" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 brush-border-top">
    <div id="incoming-list" class="grid grid-cols-1 gap-4"></div>

    <div class="mt-12 border-t-2 border-dashed border-gray-200 pt-10 relative overflow-hidden">
        <div class="absolute -right-4 top-10 text-[100px] text-gray-400 opacity-5 font-serif-thai pointer-events-none">Âè≤</div>
        
        <div class="flex justify-between items-center mb-6 relative z-10">
            <h3 class="text-xl font-bold text-[#1A1A2E] flex items-center gap-2 font-serif-thai">
                <i class="fa-solid fa-clock-rotate-left text-[#D4AF37]"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (History Log)
            </h3>
            <span class="text-[10px] bg-[#F5F0E8] px-3 py-1 border border-gray-300 rounded-sm text-gray-500 font-bold">‡πÅ‡∏™‡∏î‡∏á 50 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</span>
        </div>
        
        <div id="homework-history-list" class="space-y-3 max-h-[600px] overflow-y-auto custom-scrollbar pr-2 relative z-10">
            <div class="text-center text-gray-400 py-10 italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥...</div>
        </div>
    </div>
</section>
            
            <section id="admin-panel-material" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 flex flex-col gap-6 brush-border-top relative overflow-hidden">
                <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">‰π¶</div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 z-10">
                    <div class="md:col-span-1 bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 h-fit shadow-sm relative">
                        <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
                        <h3 class="font-bold text-[#1A1A2E] mb-4 border-b border-gray-300 pb-2 font-serif-thai">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</h3>
                        <form id="form-material" class="space-y-4">
                            <div>
                                <label class="text-xs text-gray-600 font-bold">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                                <select id="mat-subject" class="w-full bg-white border-b-2 border-gray-300 px-3 py-2 text-sm text-[#1A1A2E] outline-none focus:border-[#C53D43]" required></select>
                            </div>
                            <div>
                                <label class="text-xs text-gray-600 font-bold">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</label>
                                <input id="mat-title" type="text" class="w-full bg-white border-b-2 border-gray-300 px-3 py-2 text-sm text-[#1A1A2E] outline-none focus:border-[#C53D43]" required>
                            </div>
                            <div>
                                <label class="text-xs text-gray-600 font-bold">‡∏•‡∏¥‡∏á‡∏Å‡πå</label>
                                <input id="mat-link" type="url" class="w-full bg-white border-b-2 border-gray-300 px-3 py-2 text-sm text-[#C53D43] outline-none focus:border-[#C53D43]" placeholder="https://..." required>
                            </div>
                            <button type="submit" class="w-full bg-[#1A1A2E] hover:bg-[#C53D43] text-white py-3 rounded-sm font-bold shadow-sm transition-colors mt-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</button>
                        </form>
                    </div>
                    <div class="md:col-span-2 flex flex-col gap-4">
                        <div id="admin-mat-list" class="grid grid-cols-1 sm:grid-cols-2 gap-3 overflow-y-auto max-h-[600px] pr-2 custom-scrollbar"></div>
                    </div>
                </div>
            </section>
            
            <section id="admin-panel-management" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 flex flex-col gap-6 brush-border-top relative overflow-hidden">
                <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">Áª©</div>
                <div class="flex flex-col md:flex-row items-center justify-between gap-4 border-b border-gray-200 pb-4 z-10">
                    <div>
                        <h3 class="text-xl font-bold text-[#1A1A2E] font-serif-thai">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô (Score Manager)</h3>
                        <p class="text-xs text-gray-500">‡∏•‡∏ö‡∏á‡∏≤‡∏ô ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="document.getElementById('menu-basic').click()" class="bg-[#1A1A2E] hover:bg-[#C53D43] text-white px-4 py-2 rounded-sm text-xs font-bold shadow-sm transition-colors">
                            <i class="fa-solid fa-plus mr-1"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
                        </button>
                    </div>
                </div>

                <div class="bg-[#F5F0E8] p-4 rounded-sm border border-gray-200 z-10">
                    <label class="text-xs text-gray-600 block mb-1 font-bold">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</label>
                    <select id="manage-class-select" class="w-full bg-white border border-gray-300 rounded-sm px-4 py-2 text-sm text-[#1A1A2E] outline-none focus:border-[#C53D43]" onchange="renderScoreManagerPanel()"></select>
                </div>

                <div class="flex-1 overflow-auto bg-white rounded-sm border border-gray-200 custom-scrollbar relative min-h-[400px] shadow-sm z-10">
                    <table class="w-full text-sm text-left text-[#1A1A2E] border-collapse">
                        <thead class="text-xs text-gray-600 uppercase bg-[#F5F0E8] sticky top-0 z-10 shadow-sm border-b border-gray-300">
                            <tr id="manage-table-header"></tr>
                        </thead>
                        <tbody id="manage-table-body" class="divide-y divide-gray-200"></tbody>
                    </table>
                    
                    <div id="manage-empty-state" class="absolute inset-0 flex flex-col items-center justify-center text-gray-400 bg-white/90 backdrop-blur-sm z-20">
                        <i class="fa-solid fa-hand-pointer text-4xl mb-4 text-gray-300"></i>
                        <p class="font-bold text-[#1A1A2E]">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</p>
                    </div>
                </div>
            </section>
<section id="admin-panel-lucky" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 flex flex-col gap-6 relative overflow-hidden min-h-[600px] brush-border-top">
    <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none z-0">Ëøê</div>
    
    <div class="relative z-10 flex flex-col lg:flex-row justify-between items-center gap-4 bg-[#F5F0E8] p-4 rounded-sm border border-gray-200 shadow-sm">
        <div class="flex items-center gap-3 w-full lg:w-auto">
            <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-[#C53D43] border border-gray-300 shadow-sm">
                <i class="fa-solid fa-dice text-xl"></i>
            </div>
            <div>
                <h3 class="text-[#1A1A2E] font-bold font-serif-thai text-lg">Lucky Station</h3>
                <p class="text-xs text-gray-500 font-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</p>
            </div>
        </div>
        
        <div class="flex flex-wrap gap-2 justify-center">
            <select id="lucky-class-select" class="bg-white border border-gray-300 rounded-sm px-3 py-2 text-sm text-[#1A1A2E] focus:border-[#C53D43] outline-none transition-colors" onchange="clearLuckyHistory()">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option>
            </select>
            
            <select id="lucky-filter-att" class="bg-white border border-gray-300 rounded-sm px-3 py-2 text-sm text-[#2D6A4F] font-bold focus:border-[#C53D43] outline-none transition-colors">
                <option value="all">üåê ‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</option>
                <option value="present" selected>‚úÖ ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
            </select>
        </div>
    </div>

    <div class="relative z-10 flex-1 flex flex-col items-center justify-center gap-8 py-4">
        <div id="lucky-box" class="lucky-container w-full max-w-4xl rounded-sm p-1 transition-all duration-300">
            <div class="p-8 bg-white border border-gray-200 rounded-sm shadow-sm flex items-center justify-center min-h-[150px] relative overflow-hidden">
                <div id="lucky-result" class="text-4xl md:text-5xl font-extrabold text-gray-300 text-center tracking-widest font-serif-thai drop-shadow-sm">READY?</div>
            </div>
        </div>

        <div class="flex flex-col items-center gap-4 w-full max-w-2xl">
            <div class="flex flex-wrap justify-center gap-2 bg-[#F5F0E8] p-2 rounded-sm border border-gray-200 shadow-sm">
                <button onclick="setLuckyMode('1')" id="btn-mode-1" class="px-4 py-2 rounded-sm text-xs font-bold bg-[#1A1A2E] text-white shadow-sm transition-all mode-btn">‡πÄ‡∏î‡∏µ‡πà‡∏¢‡∏ß (1)</button>
                <button onclick="setLuckyMode('2')" id="btn-mode-2" class="px-4 py-2 rounded-sm text-xs font-bold text-gray-600 bg-white hover:border-[#1A1A2E] border border-gray-300 transition-all mode-btn">‡∏Ñ‡∏π‡πà (2)</button>
                <button onclick="setLuckyMode('group')" id="btn-mode-group" class="px-4 py-2 rounded-sm text-xs font-bold text-gray-600 bg-white hover:border-[#1A1A2E] border border-gray-300 transition-all mode-btn">‡∏Å‡∏•‡∏∏‡πà‡∏°</button>
                <input type="number" id="lucky-group-size" class="w-16 bg-white border border-gray-300 rounded-sm px-2 py-1 text-center text-xs hidden outline-none focus:border-[#C53D43]" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" min="3" value="3">
            </div>

            <div class="flex gap-4 items-center">
                <div class="flex items-center gap-2 bg-[#F5F0E8] px-3 py-2 rounded-sm border border-gray-200 shadow-sm">
                    <i class="fa-regular fa-clock text-gray-500 text-xs"></i>
                    <select id="lucky-duration" class="bg-transparent text-[#1A1A2E] text-xs font-bold outline-none cursor-pointer">
                        <option value="3000">3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
                        <option value="5000" selected>5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
                        <option value="10000">10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</option>
                    </select>
                </div>
                <label class="flex items-center gap-2 cursor-pointer bg-[#F5F0E8] px-3 py-2 rounded-sm border border-gray-200 shadow-sm hover:border-[#C53D43] transition-all">
                    <input type="checkbox" id="lucky-no-repeat" class="accent-[#C53D43] w-4 h-4" checked>
                    <span class="text-xs text-[#1A1A2E] font-bold">‡∏´‡πâ‡∏≤‡∏°‡∏ã‡πâ‡∏≥</span>
                </label>
            </div>

            <button onclick="startLuckyDraw()" id="btn-lucky-action" class="w-64 py-4 rounded-sm bg-[#C53D43] hover:bg-[#A03035] text-white text-xl font-bold shadow-md transition-all active:scale-95 border-b-4 border-[#8A252A]">
                <i class="fa-solid fa-play mr-2"></i> ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏¢!
            </button>
        </div>
    </div>

    <div class="relative z-10 bg-white rounded-sm p-4 border border-gray-200 min-h-[100px] shadow-sm">
        <div class="flex justify-between items-center mb-3 border-b border-gray-100 pb-2">
            <h4 class="text-sm font-bold text-[#1A1A2E] font-serif-thai"><i class="fa-solid fa-clock-rotate-left mr-2 text-[#D4AF37]"></i>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏ô‡∏î‡∏ß‡∏á‡∏î‡∏µ</h4>
            <button onclick="clearLuckyHistory()" class="text-[10px] text-gray-400 hover:text-[#C53D43] font-bold transition-colors"><i class="fa-solid fa-trash mr-1"></i>‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
        </div>
        <div id="lucky-history-list" class="flex flex-wrap gap-2">
            <div class="text-xs text-gray-400 italic w-full text-center py-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</div>
        </div>
    </div>
</section>

<section id="admin-panel-tools" class="admin-panel hidden bg-white border border-gray-200 shadow-sm rounded-sm p-6 brush-border-top relative overflow-hidden">
    <div class="absolute -right-4 top-10 text-[120px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none z-0">Âç°</div>
    
    <h3 class="text-xl font-bold text-[#1A1A2E] mb-6 border-b border-gray-200 pb-3 font-serif-thai relative z-10"><i class="fa-solid fa-id-card mr-2 text-[#1A1A2E]"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (QR Code)</h3>
    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10">
        <div class="bg-[#F5F0E8] p-5 rounded-sm border border-gray-200 h-fit shadow-sm relative">
            <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
            
            <label class="text-xs text-gray-600 block mb-2 font-bold">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
            <select id="card-class-select" class="w-full bg-white border border-gray-300 rounded-sm px-3 py-2.5 text-sm mb-5 text-[#1A1A2E] outline-none focus:border-[#C53D43] shadow-sm"></select>
            
            <button onclick="generateIDCards()" class="w-full bg-[#D4AF37] hover:bg-[#C39F2D] text-white py-3 rounded-sm font-bold shadow-sm mb-3 transition-colors flex justify-center items-center gap-2">
                <i class="fa-solid fa-eye"></i> ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
            </button>
            
            <button onclick="downloadSelectedCards()" class="w-full bg-[#2D6A4F] hover:bg-[#1B4332] text-white py-3 rounded-sm font-bold shadow-sm mb-3 transition-colors flex justify-center items-center gap-2">
                <i class="fa-solid fa-file-zipper"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ (ZIP)
            </button>
            
            <button onclick="printIDCards()" class="w-full bg-white text-[#1A1A2E] border border-gray-300 hover:border-[#1A1A2E] py-3 rounded-sm font-bold shadow-sm transition-colors flex justify-center items-center gap-2">
                <i class="fa-solid fa-print"></i> ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (PDF/Print)
            </button>
            
            <div class="mt-5 pt-4 border-t border-gray-300">
                <label class="flex items-center gap-2 cursor-pointer text-gray-600 hover:text-[#C53D43] text-sm font-bold transition-colors">
                    <input type="checkbox" id="select-all-cards" class="accent-[#C53D43] w-4 h-4 rounded-sm" onchange="toggleSelectAllCards(this)">
                    ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏±‡∏ï‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </label>
            </div>
        </div>
        
        <div class="md:col-span-2 bg-[#FBF9F6] rounded-sm p-4 overflow-y-auto max-h-[600px] border border-gray-200 shadow-inner custom-scrollbar">
            <div id="id-card-preview-area" class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div class="text-gray-400 text-center col-span-2 py-20 flex flex-col items-center gap-3">
                    <i class="fa-solid fa-address-card text-4xl text-gray-300"></i>
                    <p class="font-bold text-sm">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏î "‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á"</p>
                </div>
            </div>
        </div>
    </div>
</section>
        </div>
      </div>

      <div id="section-student" class="hidden flex flex-col gap-5">
        <div id="student-login-wrapper" class="flex flex-col items-center justify-center py-20 gap-8">
    <div class="bg-white p-10 rounded-sm border border-gray-200 shadow-sm w-full max-w-sm flex flex-col items-center relative brush-border-top">
        
        <div class="seal-stamp top-6 right-6 w-12 h-12 text-lg transform rotate-12">
            Áîü
        </div>

        <img src="https://img2.pic.in.th/pic/Logoc404dc85753b800c.png" alt="Logo" class="w-20 h-20 object-contain mb-4 opacity-90">
        <h2 class="text-2xl font-bold text-[#1A1A2E] mb-6 font-serif-thai tracking-wide">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
        
        <div class="w-full mt-4 space-y-6">
            <input id="student-login-id" type="text" class="w-full glass-input px-2 py-2 text-center text-[#1A1A2E] text-xl font-bold tracking-widest" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
            
            <button onclick="handleStudentLogin()" class="w-full py-3 rounded-sm bg-[#C53D43] hover:bg-[#A03035] text-white font-bold shadow-md mt-4 text-lg transition-colors">
    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
</button>
        </div>
    </div>
</div>
        <div id="student-dashboard" class="hidden flex flex-col gap-6">
             <div class="glass-ios p-6 rounded-3xl flex items-center justify-between">
                 <div><h2 id="std-dash-name" class="text-2xl font-bold text-[#1A1A2E]">-</h2><span id="std-dash-class" class="text-blue-300 font-bold text-sm">-</span> <button onclick="openEmailModal('student')" class="text-[#C53D43] hover:text-[#1A1A2E] ml-2" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏µ‡πÄ‡∏°‡∏•"><i class="fa-solid fa-envelope"></i></button></div>
                 <button onclick="handleLogout(true)" class="text-[#1A1A2E]/50 hover:text-red-400 text-xl"><i class="fa-solid fa-right-from-bracket"></i></button>
             </div>
             <div id="std-subjects-container" class="flex flex-col gap-6"></div>
        </div>
      </div>

     </div>
    </main>
    <div id="subject-config-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-[#1A1A2E]/60 backdrop-blur-sm">
        <div class="bg-white p-6 rounded-sm w-full max-w-sm shadow-md border border-gray-200 brush-border-top relative overflow-hidden">
            <div class="seal-stamp top-4 right-4 w-10 h-10 text-sm transform rotate-12 opacity-40">Áßë</div>
            <h3 class="text-lg font-bold text-[#1A1A2E] mb-2 font-serif-thai">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</h3>
            <p id="config-subject-name" class="text-[#C53D43] text-sm mb-4 font-bold border-b border-gray-200 pb-2"></p>
            <input type="hidden" id="config-subject-id">
            <div id="config-slots-container" class="space-y-3 max-h-60 overflow-y-auto mb-4 custom-scrollbar pr-1"></div>
            <div class="flex justify-between items-center text-xs text-gray-500 mb-4 border-t border-gray-200 pt-3"><span>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏ß‡∏°: <span id="config-total-score" class="font-bold text-[#1A1A2E] text-sm">0</span>/50</span><button onclick="addConfigSlot()" id="btn-add-slot" class="text-[#C53D43] hover:text-[#A03035] font-bold transition-colors"><i class="fa-solid fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á</button></div>
            <div class="grid grid-cols-2 gap-3 pt-2"><button onclick="document.getElementById('subject-config-modal').classList.add('hidden')" class="py-2.5 rounded-sm bg-[#F5F0E8] text-gray-600 hover:bg-gray-200 font-bold text-sm transition-colors border border-gray-300">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button onclick="saveSubjectConfig()" class="py-2.5 rounded-sm bg-[#1A1A2E] text-white hover:bg-[#C53D43] font-bold text-sm transition-colors shadow-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>
        </div>
    </div>

    <div id="score-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-[#1A1A2E]/60 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-sm w-full max-w-xs shadow-md transform scale-100 transition-all border border-gray-200 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-[#D4AF37]"></div>
            <h3 class="text-lg font-bold text-[#1A1A2E] mb-2 text-center font-serif-thai">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
            <p class="text-gray-500 text-sm mb-1 text-center font-bold" id="modal-task-name"></p>
            <p class="text-[#1A1A2E] text-xl font-bold mb-6 text-center border-b border-gray-200 pb-4" id="modal-student-name"></p>
            <div class="relative mb-6">
                <input id="modal-score-input" type="number" class="w-full bg-[#F5F0E8] border-b-4 border-[#C53D43] rounded-sm px-4 py-4 text-4xl text-center text-[#C53D43] font-bold focus:outline-none focus:bg-white transition-colors">
                <span class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 text-sm font-bold">/ <span id="modal-max-score"></span></span>
            </div>
            <div class="grid grid-cols-2 gap-3"><button onclick="closeScoreModal()" class="py-3 rounded-sm bg-gray-100 text-gray-600 hover:bg-gray-200 font-bold border border-gray-300 transition-colors">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button id="btn-modal-save" class="py-3 rounded-sm bg-[#1A1A2E] hover:bg-[#2D6A4F] text-white font-bold transition-colors shadow-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button></div>
        </div>
    </div>
    
    <div id="submit-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-[#1A1A2E]/60 backdrop-blur-sm">
        <div class="bg-white border border-gray-200 rounded-sm p-6 w-full max-w-sm shadow-md brush-border-top relative">
            <h3 class="text-lg font-bold text-[#1A1A2E] mb-2 font-serif-thai"><i class="fa-solid fa-paper-plane mr-2 text-[#C53D43]"></i>‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</h3>
            <p class="text-sm text-gray-500 mb-4 font-bold border-b border-gray-100 pb-2" id="submit-modal-title"></p>
            <form id="form-submit-work" class="space-y-4">
                <input type="hidden" id="submit-task-id"><input type="hidden" id="submit-student-id">
                <div><label class="text-xs text-gray-600 mb-1 block font-bold">1. ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏á‡∏≤‡∏ô</label><input id="submit-link-input" type="url" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] text-sm focus:border-[#C53D43] outline-none" placeholder="https://..." required></div>
                <div><label class="text-xs text-gray-600 mb-1 block font-bold">2. ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏π</label><textarea id="submit-comment-input" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] text-sm h-16 resize-none focus:border-[#C53D43] outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å..."></textarea></div>
                <div class="bg-[#F5F0E8] p-3 rounded-sm border border-gray-200">
                    <label class="text-xs text-[#1A1A2E] mb-2 block font-bold"><i class="fa-solid fa-users mr-1 text-[#D4AF37]"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
                    <input type="text" id="friend-search" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô..." class="w-full bg-white border border-gray-300 rounded-sm px-2 py-1.5 text-xs mb-2 outline-none focus:border-[#C53D43]">
                    <div id="friend-selector-container" class="max-h-48 overflow-y-auto grid grid-cols-1 gap-1 pr-1 custom-scrollbar"></div>
                </div>
                <div class="flex justify-end gap-2 pt-4 border-t border-gray-200"><button type="button" onclick="document.getElementById('submit-modal').classList.add('hidden')" class="px-5 py-2.5 rounded-sm bg-gray-100 text-gray-600 font-bold border border-gray-300 hover:bg-gray-200 transition-colors">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button><button type="submit" id="btn-submit-final" class="px-5 py-2.5 rounded-sm bg-[#1A1A2E] hover:bg-[#2D6A4F] text-white text-sm font-bold shadow-sm transition-colors flex items-center gap-2"><i class="fa-solid fa-paper-plane"></i> ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</button></div>
            </form>
        </div>
    </div>

    <div id="email-modal" class="hidden fixed inset-0 z-[60] flex items-center justify-center bg-[#1A1A2E]/80 backdrop-blur-sm">
        <div class="bg-white p-8 rounded-sm w-full max-w-sm shadow-md relative border border-gray-200">
            <h3 class="text-xl font-bold text-[#1A1A2E] mb-2 text-center font-serif-thai"><i class="fa-solid fa-envelope text-[#C53D43] mr-2"></i>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
            <p class="text-gray-500 text-sm mb-6 text-center">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</p>
            <input type="hidden" id="email-modal-role">
            <input type="email" id="user-email-input" class="w-full bg-[#F5F0E8] border-b-2 border-gray-300 rounded-none px-4 py-3 text-[#1A1A2E] text-center mb-6 focus:border-[#C53D43] outline-none font-bold" placeholder="yourname@email.com">
            <button type="button" onclick="saveUserEmail()" class="w-full bg-[#1A1A2E] hover:bg-[#C53D43] text-white py-3 rounded-sm font-bold shadow-sm transition-colors">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button id="btn-close-email" onclick="document.getElementById('email-modal').classList.add('hidden')" class="w-full mt-3 py-2 text-xs text-gray-400 hover:text-gray-600 hidden transition-colors font-bold">‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á</button>
        </div>
    </div>
    
    <div id="loading-overlay" class="fixed inset-0 z-[70] bg-[#F5F0E8]/90 backdrop-blur-sm hidden flex flex-col items-center justify-center">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-[#C53D43] mb-6 shadow-sm"></div>
        <p id="loading-text" class="text-[#1A1A2E] font-bold text-lg animate-pulse font-serif-thai tracking-widest">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...</p>
    </div>

    <div id="toast-notification" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-[#1A1A2E] text-white px-6 py-3 rounded-sm shadow-md z-50 flex items-center gap-3 translate-y-20 opacity-0 font-bold border-l-4 border-[#2D6A4F] transition-all duration-300">
        <i class="fa-solid fa-circle-check text-[#2D6A4F] text-xl"></i>
        <span id="toast-message" class="text-sm">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
    </div>

  <div id="print-area" class="hidden"><table id="print-table" style="width: 100%;"><thead><tr class="print-header-row"><td colspan="13" style="text-align:center; border: none; padding-bottom: 10px;"><img src="https://img2.pic.in.th/pic/Logoc404dc85753b800c.png" style="width: 70px; height: auto; margin-bottom: 5px; margin-top: 10px; display: inline-block;"><h2 style="font-size: 18px; font-weight: bold; margin: 0; line-height: 1.2;">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2><h3 style="font-size: 16px; margin: 0; line-height: 1.2;">‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô (ChineseClass System)</h3><p id="print-subtitle" style="font-size: 14px; margin-top: 5px;">‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà ... ‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà ... ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ...</p></td></tr><tr class="column-header" id="print-column-header"></tr></thead><tbody id="print-table-body"></tbody></table><div style="margin-top: 30px; display: flex; justify-content: space-between; font-size: 14px; page-break-inside: avoid;"><div style="text-align: center; width: 40%;"><p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ...........................................................</p><p>( ........................................................... )</p><p>‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏¥‡∏ä‡∏≤</p></div><div style="text-align: center; width: 40%;"><p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ...........................................................</p><p>( ........................................................... )</p><p>‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Ø</p></div></div></div>

  <script type="module" src="js/main.js"></script>
  
  <div id="edit-column-modal" class="fixed inset-0 bg-[#1A1A2E]/60 hidden items-center justify-center z-50 backdrop-blur-sm">
    <div class="bg-white border border-gray-200 p-6 rounded-sm w-96 shadow-md transform transition-all scale-100 relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-1 bg-[#1A1A2E]"></div>
        <h3 class="text-lg font-bold text-[#1A1A2E] mb-4 font-serif-thai"><i class="fa-solid fa-pen-to-square mr-2 text-[#C53D43]"></i>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
        
        <input type="hidden" id="edit-mode"> <input type="hidden" id="edit-col-id"> <input type="hidden" id="edit-col-index"> 
        <div class="mb-4">
            <label class="text-xs text-gray-500 block mb-1 font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</label>
            <input type="text" id="edit-col-name" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] outline-none focus:border-[#C53D43]" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏≠‡∏ö‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1, ‡∏à‡∏¥‡∏ï‡∏û‡∏¥‡∏™‡∏±‡∏¢">
        </div>

        <div class="mb-4">
            <label class="text-xs text-gray-500 block mb-1 font-bold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏° (Max)</label>
            <input type="number" id="edit-col-max" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] outline-none focus:border-[#C53D43]">
        </div>

        <div class="mb-6">
            <label class="text-xs text-gray-500 block mb-1 font-bold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</label>
            <select id="edit-col-category" class="w-full bg-white border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] outline-none focus:border-[#C53D43] font-bold">
            </select>
            <div id="edit-col-desc" class="text-[10px] text-[#C53D43] mt-2 bg-red-50 p-2 rounded-sm border border-red-100 hidden"></div>
        </div>

        <div class="flex gap-2">
            <button onclick="document.getElementById('edit-column-modal').classList.add('hidden')" class="flex-1 py-2.5 rounded-sm bg-gray-100 text-gray-600 hover:bg-gray-200 border border-gray-300 font-bold transition-colors">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button onclick="window.saveColumnEdit()" class="flex-1 py-2.5 rounded-sm bg-[#1A1A2E] text-white font-bold hover:bg-[#C53D43] shadow-sm transition-colors">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
    </div>
</div>

<div id="student-task-modal" class="fixed inset-0 bg-[#1A1A2E]/80 hidden items-center justify-center z-50 backdrop-blur-md">
    <div class="bg-white border border-gray-200 p-6 md:p-8 rounded-sm w-full max-w-lg shadow-md m-4 transform transition-all scale-100 relative brush-border-top">
        
        <div id="task-modal-detail" class="mb-6 p-4 bg-[#F5F0E8] rounded-sm border border-gray-200">
        </div>

        <button onclick="document.getElementById('student-task-modal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-400 hover:text-[#C53D43] transition-colors bg-white rounded-full w-8 h-8 flex items-center justify-center border border-gray-200 shadow-sm">
            <i class="fa-solid fa-xmark"></i>
        </button>

        <div class="mb-6 border-b border-gray-200 pb-4">
            <div class="flex items-center gap-3 mb-2">
                <span id="st-modal-badge" class="px-2 py-1 rounded-sm text-[10px] font-bold bg-[#1A1A2E] text-white tracking-widest">TODO</span>
                <span id="st-modal-date" class="text-xs text-[#C53D43] font-bold"><i class="fa-regular fa-clock mr-1"></i>--/--/--</span>
            </div>
            <h3 id="st-modal-title" class="text-xl font-bold text-[#1A1A2E] leading-tight font-serif-thai">‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô...</h3>
            <p id="st-modal-desc" class="text-sm text-gray-600 mt-2 leading-relaxed">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô...</p>
        </div>

        <div class="space-y-4">
            <div id="st-modal-feedback-area" class="bg-[#F5F0E8] rounded-sm p-4 border border-[#2D6A4F] hidden relative overflow-hidden">
                <div class="absolute left-0 top-0 w-1 h-full bg-[#2D6A4F]"></div>
                <div class="flex justify-between items-center mb-2 pl-2">
                    <h4 class="text-sm font-bold text-[#1A1A2E]"><i class="fa-solid fa-chalkboard-user mr-2 text-[#2D6A4F]"></i>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</h4>
                    <span id="st-modal-score" class="text-xl font-bold text-[#2D6A4F]">10/10</span>
                </div>
                <div id="st-modal-comment" class="text-sm text-gray-600 italic bg-white p-3 rounded-sm border-l-4 border-gray-300 shadow-sm ml-2 mt-2">
                    "‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö ‡∏ó‡∏≥‡∏ï‡πà‡∏≠‡πÑ‡∏õ!"
                </div>
            </div>

            <div>
                <label class="text-sm font-bold text-[#1A1A2E] block mb-2"><i class="fa-solid fa-link mr-2 text-[#C53D43]"></i>‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô (‡∏•‡∏¥‡∏á‡∏Å‡πå ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°)</label>
                <textarea id="st-modal-submission" rows="3" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-3 text-[#1A1A2E] text-sm outline-none focus:border-[#C53D43] transition-colors" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Google Drive, Canva ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
                <p class="text-[10px] text-gray-500 mt-1 text-right font-bold">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏ï‡∏•‡∏≠‡∏î‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏π‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à</p>
            </div>
        </div>
        
        <div class="bg-white p-4 rounded-sm border border-gray-200 mt-4 shadow-sm">
            <label class="text-xs text-[#1A1A2E] mb-2 block font-bold">
                <i class="fa-solid fa-users mr-1 text-[#D4AF37]"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            </label>
            <input type="text" id="st-friend-search" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô..." class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-xs mb-2 outline-none focus:border-[#D4AF37]">
            <div id="st-friend-list" class="max-h-32 overflow-y-auto grid grid-cols-1 gap-1 pr-1 custom-scrollbar"></div>
        </div>

        <div class="mt-6 flex gap-3 pt-4 border-t border-gray-100">
            <button onclick="document.getElementById('student-task-modal').classList.add('hidden')" class="px-5 py-2.5 rounded-sm bg-gray-100 text-gray-600 border border-gray-300 hover:bg-gray-200 transition-colors font-bold">‡∏õ‡∏¥‡∏î</button>
            <button onclick="window.submitWork()" id="st-modal-submit-btn" class="flex-1 px-4 py-2.5 rounded-sm bg-[#1A1A2E] text-white font-bold hover:bg-[#2D6A4F] shadow-sm transition-all flex justify-center items-center gap-2">
                <i class="fa-solid fa-paper-plane"></i> ‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô
            </button>
        </div>
        <input type="hidden" id="st-modal-task-id">
        <input type="hidden" id="st-modal-student-id">
    </div>
</div>

<div id="exam-editor-modal" class="fixed inset-0 bg-[#1A1A2E]/80 hidden z-50 flex items-center justify-center backdrop-blur-sm p-4">
    <div class="bg-white w-full max-w-5xl h-[95vh] rounded-sm border border-gray-200 shadow-md flex flex-col overflow-hidden relative">
        <div class="absolute top-0 left-0 w-full h-1 bg-[#C53D43] z-50"></div>
        
        <div class="p-4 border-b border-gray-200 flex justify-between items-center bg-[#F5F0E8]">
            <h2 class="text-lg md:text-xl font-bold text-[#1A1A2E] flex items-center gap-2 font-serif-thai">
                <i class="fa-solid fa-file-pen text-[#C53D43]"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö
            </h2>
            
            <div class="flex gap-2">
                <button onclick="downloadWordTemplate()" class="text-xs bg-white text-[#1A1A2E] border border-gray-300 px-3 py-1.5 rounded-sm hover:bg-gray-100 transition-colors font-bold shadow-sm">
                    <i class="fa-solid fa-download mr-1"></i>‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏°‡πà‡πÅ‡∏ö‡∏ö
                </button>
                <label class="text-xs bg-[#1A1A2E] text-white px-3 py-1.5 rounded-sm hover:bg-[#C53D43] transition-colors cursor-pointer flex items-center shadow-sm font-bold">
                    <i class="fa-solid fa-file-word mr-1"></i> ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Word
                    <input type="file" id="import-word-input" accept=".docx" class="hidden" onchange="importExamFromWord(this)">
                </label>
                <button onclick="closeExamModal()" class="text-gray-400 hover:text-[#C53D43] transition-colors ml-2 bg-white rounded-full w-8 h-8 flex items-center justify-center border border-gray-200 shadow-sm">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto p-4 md:p-6 custom-scrollbar bg-white">
            <form id="exam-form" onsubmit="event.preventDefault(); saveExamData();">
                <input type="hidden" id="exam-id"> 
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="col-span-2">
                        <label class="block text-xs text-gray-500 mb-1 font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö</label>
                        <input type="text" id="exam-title" required class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-2.5 text-[#1A1A2E] focus:border-[#C53D43] outline-none font-bold" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ ‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô 1">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1 font-bold">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                        <select id="exam-subject" required class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-2.5 text-[#1A1A2E] focus:border-[#C53D43] outline-none font-bold">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤ --</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 p-5 bg-[#F5F0E8] rounded-sm border border-gray-200">
                    <div>
                        <label class="block text-xs text-[#1A1A2E] mb-2 font-bold"><i class="fa-solid fa-bullseye text-[#C53D43] mr-1"></i> ‡∏ô‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏õ‡∏£‡∏ß‡∏°‡πÉ‡∏ô (‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà)</label>
                        <select id="exam-category" class="w-full bg-white border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] outline-none font-bold">
                            <option value="none">‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏¢‡∏Å)</option>
                            <option value="accum">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                            <option value="midterm">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏Ñ</option>
                            <option value="final">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö‡∏õ‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏Ñ</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-xs text-[#1A1A2E] mb-2 font-bold"><i class="fa-solid fa-book-bookmark text-[#D4AF37] mr-1"></i> ‡∏ö‡∏ó‡∏ó‡∏µ‡πà (‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏ö‡∏ó)</label>
                        <div id="exam-chapter-container" class="grid grid-cols-5 md:grid-cols-10 gap-2 p-3 bg-white border border-gray-200 rounded-sm max-h-32 overflow-y-auto">
                            <script>
                                for(let i=1; i<=6; i++) {
                                    document.write(`
                                        <label class="flex items-center gap-1.5 cursor-pointer hover:bg-gray-100 p-1 rounded-sm transition-colors border border-transparent hover:border-gray-200">
                                            <input type="checkbox" value="${i}" class="exam-chapter-cb w-3.5 h-3.5 accent-[#C53D43] rounded-sm">
                                            <span class="text-xs text-[#1A1A2E] font-bold">${i}</span>
                                        </label>
                                    `);
                                }
                            </script>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 p-5 bg-white border border-gray-200 rounded-sm shadow-sm relative">
                    <div class="absolute top-0 left-0 w-1 h-full bg-[#1A1A2E]"></div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1 font-bold"><i class="fa-regular fa-clock mr-1"></i> ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏≠‡∏ö (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
                        <input type="number" id="exam-duration" value="60" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] text-center font-bold outline-none focus:border-[#C53D43]">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1 font-bold"><i class="fa-solid fa-desktop mr-1"></i> ‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÑ‡∏î‡πâ (‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</label>
                        <input type="number" id="exam-max-switch" value="2" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-[#C53D43] text-center font-bold outline-none focus:border-[#C53D43]">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1 font-bold"><i class="fa-solid fa-key mr-1"></i> ‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≠‡∏ö</label>
                        <input type="text" id="exam-password" value="1234" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] text-center tracking-widest font-mono font-bold outline-none focus:border-[#C53D43]">
                    </div>
                    <div class="flex items-center justify-center gap-4 pt-4 bg-[#F5F0E8] border border-gray-200 rounded-sm">
                        <label class="flex items-center gap-2 cursor-pointer group">
                            <input type="checkbox" id="exam-shuffle-q" class="w-4 h-4 accent-[#1A1A2E]">
                            <span class="text-sm text-[#1A1A2E] font-bold group-hover:text-[#C53D43]">‡∏™‡∏•‡∏±‡∏ö‡∏Ç‡πâ‡∏≠</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer group">
                            <input type="checkbox" id="exam-shuffle-c" class="w-4 h-4 accent-[#1A1A2E]">
                            <span class="text-sm text-[#1A1A2E] font-bold group-hover:text-[#C53D43]">‡∏™‡∏•‡∏±‡∏ö‡∏ä‡πâ‡∏≠‡∏¢‡∏™‡πå</span>
                        </label>
                    </div>
                </div>

                <div class="mb-4 flex flex-col sm:flex-row justify-between sm:items-end gap-4 border-b border-gray-200 pb-3">
                    <h3 class="text-lg font-bold text-[#1A1A2E] flex items-center gap-2 font-serif-thai">
                        ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° <span id="q-count-badge" class="bg-[#C53D43] text-white text-xs px-2.5 py-0.5 rounded-sm shadow-sm font-sans">0</span>
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        <button type="button" onclick="addQuestionItem()" class="text-sm bg-[#1A1A2E] text-white font-bold px-4 py-2 rounded-sm hover:bg-[#C53D43] shadow-sm transition-colors flex items-center gap-1">
                            <i class="fa-solid fa-plus"></i> ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö
                        </button>
                        <button type="button" onclick="addSectionDivider()" class="text-sm bg-white border border-gray-300 text-[#1A1A2E] font-bold px-4 py-2 rounded-sm hover:border-[#D4AF37] hover:text-[#D4AF37] shadow-sm transition-colors flex items-center gap-1">
                            <i class="fa-solid fa-layer-group"></i> ‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà
                        </button>
                        <button type="button" onclick="addPassageDivider()" class="text-sm bg-[#F5F0E8] border border-gray-300 text-[#1A1A2E] font-bold px-4 py-2 rounded-sm hover:bg-white hover:border-[#1A1A2E] shadow-sm transition-colors flex items-center gap-1">
                            <i class="fa-solid fa-book-open"></i> ‡∏ö‡∏ó‡∏≠‡πà‡∏≤‡∏ô
                        </button>
                    </div>
                </div>

                <div id="questions-container" class="space-y-4 pb-10"></div>
            </form>
        </div>

        <div class="p-4 border-t border-gray-200 bg-[#F5F0E8] flex justify-end gap-3 z-10">
            <button onclick="closeExamModal()" class="px-6 py-2.5 rounded-sm bg-white text-gray-600 border border-gray-300 font-bold hover:bg-gray-100 transition-colors">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button onclick="saveExamData()" class="px-8 py-2.5 rounded-sm bg-[#2D6A4F] text-white font-bold hover:bg-[#1B4332] shadow-sm transition-colors flex items-center gap-2">
                <i class="fa-solid fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö
            </button>
        </div>
    </div>
</div>

<div id="exam-room-overlay" class="fixed inset-0 bg-[#F5F0E8] z-[9999] hidden flex flex-col">
    <div class="h-16 bg-white border-b border-gray-300 flex justify-between items-center px-4 md:px-6 shadow-sm">
        <div class="text-[#1A1A2E] font-bold text-base md:text-lg truncate w-1/3 font-serif-thai" id="exam-room-title">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤ - ‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</div>
        
        <div class="flex items-center gap-4">
            <div class="bg-[#F5F0E8] px-4 py-1.5 rounded-sm border border-[#C53D43] flex items-center gap-2 shadow-[inset_0_0_5px_rgba(197,61,67,0.1)]">
                <i class="fa-regular fa-clock text-[#C53D43] animate-pulse"></i>
                <span id="exam-timer" class="font-mono text-2xl text-[#C53D43] font-extrabold tracking-wider">00:00</span>
            </div>
            <div id="cheat-warning-box" class="hidden bg-red-50 border border-[#C53D43] text-[#C53D43] px-3 py-1.5 rounded-sm text-xs font-bold shadow-sm">
                ‚ö†Ô∏è ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï: <span id="warn-count" class="text-lg">0</span>/<span id="max-warn">2</span>
            </div>
        </div>

        <div class="w-1/3 text-right">
            <button onclick="submitExam()" class="bg-[#1A1A2E] hover:bg-[#2D6A4F] text-white px-5 md:px-6 py-2.5 rounded-sm font-bold shadow-sm transition-colors flex items-center gap-2 ml-auto">
                ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö <i class="fa-solid fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <div class="flex-1 overflow-hidden flex">
        <div class="w-64 bg-white border-r border-gray-200 p-4 flex flex-col hidden md:flex shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)] z-10">
            <h3 class="text-[#1A1A2E] text-sm mb-4 font-bold border-b border-gray-200 pb-2 font-serif-thai"><i class="fa-solid fa-list-check text-[#C53D43] mr-2"></i> ‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
            <div id="exam-nav-grid" class="grid grid-cols-4 gap-2 overflow-y-auto custom-scrollbar content-start pr-1"></div>
        </div>

        <div class="flex-1 overflow-y-auto p-4 md:p-8 custom-scrollbar flex justify-center bg-[#FBF9F6]" id="question-display-area">
        </div>
    </div>
</div>

<div id="exam-monitor-modal" class="fixed inset-0 bg-[#1A1A2E]/80 hidden z-[100] flex items-center justify-center backdrop-blur-md p-4">
    <div class="bg-[#F5F0E8] w-full max-w-7xl h-[95vh] rounded-sm border border-gray-200 shadow-md flex flex-col overflow-hidden relative">
        <div class="absolute top-0 left-0 w-full h-1 bg-[#1A1A2E] z-50"></div>

        <div class="p-4 border-b border-gray-300 flex flex-col gap-4 bg-white shadow-sm z-10">
            <div class="flex justify-between items-center">
                <div class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4">
                    <h2 class="text-xl font-bold text-[#1A1A2E] font-serif-thai"><i class="fa-solid fa-tv text-[#C53D43] mr-2"></i> ‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</h2>
                    <div class="h-6 w-px bg-gray-300 hidden md:block"></div>
                    <span id="monitor-exam-title" class="text-[#1A1A2E] font-bold bg-[#F5F0E8] px-3 py-1 rounded-sm border border-gray-200 shadow-sm text-sm">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
                </div>
                <div class="flex gap-2">
                    <button onclick="refreshMonitor()" class="bg-white border border-gray-300 text-gray-600 hover:text-[#1A1A2E] hover:border-[#1A1A2E] px-4 py-2 rounded-sm text-sm font-bold transition-colors shadow-sm"><i class="fa-solid fa-rotate"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
                    <button onclick="closeMonitorModal()" class="bg-[#1A1A2E] hover:bg-[#C53D43] text-white px-4 py-2 rounded-sm text-sm font-bold transition-colors shadow-sm"><i class="fa-solid fa-xmark mr-1"></i> ‡∏õ‡∏¥‡∏î</button>
                </div>
            </div>

            <div class="flex items-center gap-3 bg-[#F5F0E8] p-3 rounded-sm border border-gray-200 overflow-x-auto custom-scrollbar shadow-inner">
                <span class="text-xs text-[#1A1A2E] whitespace-nowrap font-bold"><i class="fa-solid fa-filter mr-1 text-[#C53D43]"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á:</span>
                <div id="monitor-class-filter" class="flex items-center gap-2"></div>
            </div>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-white border-b border-gray-200 z-10">
           <div class="bg-white border-t-4 border-t-[#1A1A2E] border-x border-b border-gray-200 p-4 rounded-sm text-center shadow-sm">
                <div class="text-3xl font-bold text-[#1A1A2E]" id="stat-total">0</div>
                <div class="text-[10px] text-gray-500 font-bold uppercase mt-1">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            </div>
            <div class="bg-[#F5F0E8] border-t-4 border-t-[#D4AF37] border-x border-b border-gray-200 p-4 rounded-sm text-center shadow-sm">
                <div class="text-3xl font-bold text-[#D4AF37]" id="stat-testing">0</div>
                <div class="text-[10px] text-gray-500 font-bold uppercase mt-1">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏≠‡∏ö</div>
            </div>
            <div class="bg-white border-t-4 border-t-[#2D6A4F] border-x border-b border-gray-200 p-4 rounded-sm text-center shadow-sm">
                <div class="text-3xl font-bold text-[#2D6A4F]" id="stat-finished">0</div>
                <div class="text-[10px] text-gray-500 font-bold uppercase mt-1">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</div>
            </div>
            <div class="bg-red-50 border-t-4 border-t-[#C53D43] border-x border-b border-gray-200 p-4 rounded-sm text-center shadow-sm">
                <div class="text-3xl font-bold text-[#C53D43]" id="stat-cheated">0</div>
                <div class="text-[10px] text-[#C53D43] font-bold uppercase mt-1">‡∏ó‡∏∏‡∏à‡∏£‡∏¥‡∏ï/‡∏ú‡∏¥‡∏î‡∏Å‡∏é</div>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto p-4 md:p-6 bg-[#FBF9F6] custom-scrollbar">
            <div id="monitor-student-grid" class="grid grid-cols-2 md:grid-cols-4 xl:grid-cols-6 gap-4"></div>
        </div>
    </div>
</div>

<div id="material-modal" class="fixed inset-0 bg-[#1A1A2E]/80 z-[60] hidden flex items-center justify-center p-4 backdrop-blur-sm">
    <div class="bg-white border border-gray-200 rounded-sm w-full max-w-lg p-8 shadow-md relative brush-border-top">
        <h3 class="text-xl font-bold text-[#1A1A2E] mb-6 flex items-center gap-2 font-serif-thai border-b border-gray-200 pb-3">
            <i class="fa-solid fa-layer-group text-[#D4AF37]"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤/‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        </h3>
        
        <div class="space-y-4">
            <div>
                <label class="text-xs text-gray-600 block mb-1 font-bold">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠/‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</label>
                <input type="text" id="mat-input-title" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-2.5 text-[#1A1A2E] focus:border-[#C53D43] outline-none font-bold" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1 ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô">
            </div>
            
            <div>
                <label class="text-xs text-gray-600 block mb-1 font-bold">‡∏ß‡∏¥‡∏ä‡∏≤</label>
                <select id="mat-input-subject" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-2.5 text-[#1A1A2E] focus:border-[#C53D43] outline-none font-bold"></select>
            </div>

            <div>
                <label class="text-xs text-gray-600 block mb-1 font-bold">‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ (URL)</label>
                <input type="text" id="mat-input-link" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-2.5 text-[#C53D43] focus:border-[#C53D43] outline-none font-bold" placeholder="https://...">
            </div>

            <div>
                <label class="text-xs text-gray-600 block mb-1 font-bold">‡∏£‡∏π‡∏õ‡∏õ‡∏Å/‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û - ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ)</label>
                <input type="text" id="mat-input-img" class="w-full bg-white border border-gray-300 rounded-sm px-4 py-2.5 text-[#1A1A2E] focus:border-[#C53D43] outline-none text-sm" placeholder="https://...">
            </div>

            <div class="bg-[#F5F0E8] p-3 rounded-sm border border-gray-200">
                <label class="text-xs text-[#1A1A2E] block mb-2 font-bold"><i class="fa-solid fa-display mr-1 text-gray-400"></i> ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</label>
                <select id="mat-input-type" class="w-full bg-white border border-gray-300 rounded-sm px-3 py-2 text-[#1A1A2E] focus:border-[#C53D43] outline-none font-bold text-sm">
                    <option value="newtab">üîó ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà (External Link)</option>
                    <option value="embed">üñ•Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ (Embed View)</option>
                </select>
            </div>
        </div>

        <div class="flex justify-end gap-3 mt-8 pt-4 border-t border-gray-100">
            <button onclick="document.getElementById('material-modal').classList.add('hidden')" class="px-5 py-2.5 rounded-sm bg-gray-100 text-gray-600 hover:bg-gray-200 border border-gray-300 transition-colors font-bold">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button onclick="window.saveMaterial()" class="px-6 py-2.5 rounded-sm bg-[#1A1A2E] hover:bg-[#D4AF37] text-white font-bold shadow-sm transition-colors flex items-center gap-2"><i class="fa-solid fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
    </div>
</div>

<div id="material-viewer-modal" class="fixed inset-0 bg-[#1A1A2E]/90 z-[70] hidden flex flex-col backdrop-blur-md">
    <div class="flex justify-between items-center p-4 bg-white border-b border-gray-300 shadow-sm z-10">
        <h3 id="viewer-title" class="text-lg font-bold text-[#1A1A2E] truncate max-w-[80%] font-serif-thai">‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</h3>
        <button onclick="closeMaterialViewer()" class="bg-[#1A1A2E] text-white hover:bg-[#C53D43] font-bold px-4 py-1.5 rounded-sm transition-colors flex items-center gap-2 shadow-sm">
            <i class="fa-solid fa-xmark"></i> ‡∏õ‡∏¥‡∏î
        </button>
    </div>
    <div class="flex-1 w-full h-full relative overflow-hidden bg-[#F5F0E8]">
        <iframe id="viewer-iframe" class="w-full h-full border-0" src="" allowfullscreen></iframe>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>

<div id="admin-password-modal" class="fixed inset-0 bg-[#1A1A2E]/80 z-[60] hidden flex items-center justify-center p-4 backdrop-blur-sm">
    <div class="bg-white border border-gray-200 rounded-sm w-full max-w-md overflow-hidden shadow-md transform transition-all brush-border-top relative">
        <div class="absolute -right-4 top-10 text-[80px] text-[#C53D43] opacity-5 font-serif-thai pointer-events-none">ÁÆ°</div>
        <div class="bg-[#F5F0E8] border-b border-gray-200 p-5 flex justify-between items-center relative z-10">
            <h3 class="text-lg font-bold text-[#1A1A2E] flex items-center gap-2 font-serif-thai">
                <i class="fa-solid fa-user-shield text-[#D4AF37]"></i> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö
            </h3>
            <button onclick="window.closeChangePasswordModal()" class="text-gray-400 hover:text-[#C53D43] transition-colors bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-sm border border-gray-200">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        <div class="p-6 md:p-8 relative z-10">
            <div class="bg-red-50 border border-red-100 rounded-sm p-3 mb-6">
                <p class="text-xs text-[#C53D43] font-bold text-center"><i class="fa-solid fa-circle-info mr-1"></i> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Username ‡πÅ‡∏•‡∏∞ Password ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏Ñ‡∏£‡∏π‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô</p>
            </div>
            <div class="space-y-5">
                <div>
                    <label class="text-xs text-gray-600 block mb-1 font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Username) ‡πÉ‡∏´‡∏°‡πà</label>
                    <input type="text" id="setting-admin-user" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-3 text-[#1A1A2E] text-center font-bold text-lg focus:border-[#C53D43] outline-none transition-colors" placeholder="‡πÄ‡∏ä‡πà‡∏ô admin">
                </div>
                <div>
                    <label class="text-xs text-gray-600 block mb-1 font-bold">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Password) ‡πÉ‡∏´‡∏°‡πà</label>
                    <input type="text" id="setting-admin-pass" class="w-full bg-[#F5F0E8] border border-gray-300 rounded-sm px-4 py-3 text-[#1A1A2E] text-center font-bold text-lg tracking-widest focus:border-[#C53D43] outline-none transition-colors" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà">
                </div>
            </div>
            <div class="mt-8 flex justify-end gap-3 pt-4 border-t border-gray-100">
                <button onclick="window.closeChangePasswordModal()" class="px-5 py-3 rounded-sm bg-gray-100 hover:bg-gray-200 text-gray-600 font-bold border border-gray-300 transition-colors">
                    ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                </button>
                <button onclick="window.saveAdminCredentials()" class="px-6 py-3 rounded-sm bg-[#1A1A2E] hover:bg-[#D4AF37] text-white font-bold shadow-sm transition-colors flex items-center gap-2">
                    <i class="fa-solid fa-floppy-disk"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                </button>
            </div>
        </div>
    </div>
</div>
</body>
</html>